{{> layout/header}}

<main class="profile-container">
    <section class="profile-header">
        {{#userInfo.user}}
            <div class="profile-image">
                <img src="/images/person.jpeg" alt="{{username}}의 프로필 이미지">
            </div>
            <div class="profile-info">
                <h1 class="profile-username">{{username}}</h1>
                <div class="profile-stats">
                    <span>Follower <strong>80</strong></span>
                    <span>Following <strong>116</strong></span>
                </div>
                <p class="profile-fullname">{{nickname}}</p>
                <p class="profile-bio"></p>
                {{#userInfo.isOwner}}
                    <button class="profile-edit-btn">프로필 편집</button>
                    <button class="profile-logout-btn" onclick="location.href='/logout'">로그아웃</button>
                {{/userInfo.isOwner}}
                {{^userInfo.isOwner}}
                    <button class="profile-follow-btn" id="followBtn">팔로우</button>
                    <button class="profile-unfollow-btn" id="unfollowBtn" style="display: none;">언팔로우</button>
                {{/userInfo.isOwner}}
            </div>
        {{/userInfo.user}}
    </section>

    <nav class="profile-nav">
        <a href="#" class="active">게시물</a>
        <a href="#">보관됨</a>
        <a href="#">태그됨</a>
    </nav>

    <!--<section class="profile-posts-grid">
        {{#posts}}
            <div class="profile-post-item">
                <img src="{{imageUrl}}" alt="게시물 이미지">
                <div class="profile-post-overlay">
                    <span><i class="fas fa-heart"></i> {{likeCount}}</span>
                    <span><i class="fas fa-comment"></i> {{commentCount}}</span>
                </div>
            </div>
        {{/posts}}
    </section>-->
</main>

{{> layout/footer}}

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const followBtn = document.getElementById('followBtn');
        const unfollowBtn = document.getElementById('unfollowBtn');
        const userId = {{userInfo.user.userId}};/* 여기에 현재 프로필의 사용자 ID를 설정 */;

        if (followBtn && unfollowBtn) {
            followBtn.addEventListener('click', function() {
                fetch(`/api/follow/${userId}`, {
                    method: 'POST',
                    credentials: 'same-origin'
                })
                        .then(response => response.json())
                        .then(data => {
                            followBtn.style.display = 'none';
                            unfollowBtn.style.display = 'inline-block';
                        })
                        .catch(error => console.error('Error:', error));
            });

            unfollowBtn.addEventListener('click', function() {
                fetch(`/api/unfollow/${userId}`, {
                    method: 'POST',
                    credentials: 'same-origin'
                })
                        .then(response => response.json())
                        .then(data => {
                            unfollowBtn.style.display = 'none';
                            followBtn.style.display = 'inline-block';
                        })
                        .catch(error => console.error('Error:', error));
            });
        }
    });
</script>